{"remainingRequest":"/Users/yanagi/programming/live-chat-vuejs/node_modules/babel-loader/lib/index.js!/Users/yanagi/programming/live-chat-vuejs/node_modules/vue-loader-v16/dist/templateLoader.js??ref--6!/Users/yanagi/programming/live-chat-vuejs/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/yanagi/programming/live-chat-vuejs/node_modules/vue-loader-v16/dist/index.js??ref--1-1!/Users/yanagi/programming/live-chat-vuejs/src/components/ChatWindow.vue?vue&type=template&id=3af19f98&scoped=true","dependencies":[{"path":"/Users/yanagi/programming/live-chat-vuejs/src/components/ChatWindow.vue","mtime":1638953146658},{"path":"/Users/yanagi/programming/live-chat-vuejs/babel.config.js","mtime":1637909021919},{"path":"/Users/yanagi/programming/live-chat-vuejs/node_modules/cache-loader/dist/cjs.js","mtime":1637908768660},{"path":"/Users/yanagi/programming/live-chat-vuejs/node_modules/babel-loader/lib/index.js","mtime":1637908770962},{"path":"/Users/yanagi/programming/live-chat-vuejs/node_modules/vue-loader-v16/dist/templateLoader.js","mtime":1637908771736},{"path":"/Users/yanagi/programming/live-chat-vuejs/node_modules/cache-loader/dist/cjs.js","mtime":1637908768660},{"path":"/Users/yanagi/programming/live-chat-vuejs/node_modules/vue-loader-v16/dist/index.js","mtime":1637908768201}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZnVuY3Rpb24ubmFtZS5qcyI7CmltcG9ydCB7IGNyZWF0ZUVsZW1lbnRWTm9kZSBhcyBfY3JlYXRlRWxlbWVudFZOb2RlLCByZW5kZXJMaXN0IGFzIF9yZW5kZXJMaXN0LCBGcmFnbWVudCBhcyBfRnJhZ21lbnQsIG9wZW5CbG9jayBhcyBfb3BlbkJsb2NrLCBjcmVhdGVFbGVtZW50QmxvY2sgYXMgX2NyZWF0ZUVsZW1lbnRCbG9jaywgdG9EaXNwbGF5U3RyaW5nIGFzIF90b0Rpc3BsYXlTdHJpbmcsIHJlc29sdmVDb21wb25lbnQgYXMgX3Jlc29sdmVDb21wb25lbnQsIGNyZWF0ZVZOb2RlIGFzIF9jcmVhdGVWTm9kZSwgY3JlYXRlQ29tbWVudFZOb2RlIGFzIF9jcmVhdGVDb21tZW50Vk5vZGUsIGNyZWF0ZVRleHRWTm9kZSBhcyBfY3JlYXRlVGV4dFZOb2RlLCBub3JtYWxpemVDbGFzcyBhcyBfbm9ybWFsaXplQ2xhc3MsIHB1c2hTY29wZUlkIGFzIF9wdXNoU2NvcGVJZCwgcG9wU2NvcGVJZCBhcyBfcG9wU2NvcGVJZCB9IGZyb20gInZ1ZSI7Cgp2YXIgX3dpdGhTY29wZUlkID0gZnVuY3Rpb24gX3dpdGhTY29wZUlkKG4pIHsKICByZXR1cm4gX3B1c2hTY29wZUlkKCJkYXRhLXYtM2FmMTlmOTgiKSwgbiA9IG4oKSwgX3BvcFNjb3BlSWQoKSwgbjsKfTsKCnZhciBfaG9pc3RlZF8xID0gewogIGNsYXNzOiAiY2hhdC13aW5kb3ciCn07Cgp2YXIgX2hvaXN0ZWRfMiA9IC8qI19fUFVSRV9fKi9fd2l0aFNjb3BlSWQoZnVuY3Rpb24gKCkgewogIHJldHVybiAvKiNfX1BVUkVfXyovX2NyZWF0ZUVsZW1lbnRWTm9kZSgiaDEiLCBudWxsLCAi44OB44Oj44OD44OI44Km44Kj44Oz44OJ44KmIiwgLTEKICAvKiBIT0lTVEVEICovCiAgKTsKfSk7Cgp2YXIgX2hvaXN0ZWRfMyA9IHsKICBrZXk6IDAsCiAgY2xhc3M6ICJtZXNzYWdlcyIKfTsKdmFyIF9ob2lzdGVkXzQgPSB7CiAgY2xhc3M6ICJuYW1lIgp9Owp2YXIgX2hvaXN0ZWRfNSA9IFsib25EYmxjbGljayJdOwp2YXIgX2hvaXN0ZWRfNiA9IHsKICBrZXk6IDAsCiAgY2xhc3M6ICJoZWFydC1jb250YWluZXIiCn07CnZhciBfaG9pc3RlZF83ID0gewogIGNsYXNzOiAiaGVhcnQtY291bnQiCn07CnZhciBfaG9pc3RlZF84ID0gewogIGNsYXNzOiAiY3JlYXRlZC1hdCIKfTsKZXhwb3J0IGZ1bmN0aW9uIHJlbmRlcihfY3R4LCBfY2FjaGUsICRwcm9wcywgJHNldHVwLCAkZGF0YSwgJG9wdGlvbnMpIHsKICB2YXIgX2NvbXBvbmVudF9mb250X2F3ZXNvbWVfaWNvbiA9IF9yZXNvbHZlQ29tcG9uZW50KCJmb250LWF3ZXNvbWUtaWNvbiIpOwoKICByZXR1cm4gX29wZW5CbG9jaygpLCBfY3JlYXRlRWxlbWVudEJsb2NrKCJkaXYiLCBfaG9pc3RlZF8xLCBbX2hvaXN0ZWRfMiwgJHByb3BzLm1lc3NhZ2VzID8gKF9vcGVuQmxvY2soKSwgX2NyZWF0ZUVsZW1lbnRCbG9jaygiZGl2IiwgX2hvaXN0ZWRfMywgWyhfb3BlbkJsb2NrKHRydWUpLCBfY3JlYXRlRWxlbWVudEJsb2NrKF9GcmFnbWVudCwgbnVsbCwgX3JlbmRlckxpc3QoJHByb3BzLm1lc3NhZ2VzLCBmdW5jdGlvbiAobWVzc2FnZSkgewogICAgcmV0dXJuIF9vcGVuQmxvY2soKSwgX2NyZWF0ZUVsZW1lbnRCbG9jaygidWwiLCB7CiAgICAgIGtleTogbWVzc2FnZS5pZAogICAgfSwgW19jcmVhdGVFbGVtZW50Vk5vZGUoImxpIiwgewogICAgICBjbGFzczogX25vcm1hbGl6ZUNsYXNzKHsKICAgICAgICByZWNlaXZlZDogbWVzc2FnZS5lbWFpbCAhPT0gJGRhdGEudWlkLAogICAgICAgIHNlbnQ6IG1lc3NhZ2UuZW1haWwgPT09ICRkYXRhLnVpZAogICAgICB9KQogICAgfSwgW19jcmVhdGVFbGVtZW50Vk5vZGUoInNwYW4iLCBfaG9pc3RlZF80LCBfdG9EaXNwbGF5U3RyaW5nKG1lc3NhZ2UubmFtZSksIDEKICAgIC8qIFRFWFQgKi8KICAgICksIF9jcmVhdGVFbGVtZW50Vk5vZGUoImRpdiIsIHsKICAgICAgY2xhc3M6ICJtZXNzYWdlIiwKICAgICAgb25EYmxjbGljazogZnVuY3Rpb24gb25EYmxjbGljaygkZXZlbnQpIHsKICAgICAgICByZXR1cm4gJG9wdGlvbnMuaGFuZGxlTGlrZShtZXNzYWdlKTsKICAgICAgfQogICAgfSwgW19jcmVhdGVUZXh0Vk5vZGUoX3RvRGlzcGxheVN0cmluZyhtZXNzYWdlLmNvbnRlbnQpICsgIiAiLCAxCiAgICAvKiBURVhUICovCiAgICApLCBtZXNzYWdlLmxpa2VzLmxlbmd0aCA/IChfb3BlbkJsb2NrKCksIF9jcmVhdGVFbGVtZW50QmxvY2soImRpdiIsIF9ob2lzdGVkXzYsIFtfY3JlYXRlVk5vZGUoX2NvbXBvbmVudF9mb250X2F3ZXNvbWVfaWNvbiwgewogICAgICBpY29uOiAiaGVhcnQiLAogICAgICBjbGFzczogImhlYXJ0IgogICAgfSksIF9jcmVhdGVFbGVtZW50Vk5vZGUoInNwYW4iLCBfaG9pc3RlZF83LCBfdG9EaXNwbGF5U3RyaW5nKG1lc3NhZ2UubGlrZXMubGVuZ3RoKSwgMQogICAgLyogVEVYVCAqLwogICAgKV0pKSA6IF9jcmVhdGVDb21tZW50Vk5vZGUoInYtaWYiLCB0cnVlKV0sIDQwCiAgICAvKiBQUk9QUywgSFlEUkFURV9FVkVOVFMgKi8KICAgICwgX2hvaXN0ZWRfNSksIF9jcmVhdGVFbGVtZW50Vk5vZGUoInNwYW4iLCBfaG9pc3RlZF84LCBfdG9EaXNwbGF5U3RyaW5nKG1lc3NhZ2UuY3JlYXRlZF9hdCksIDEKICAgIC8qIFRFWFQgKi8KICAgICldLCAyCiAgICAvKiBDTEFTUyAqLwogICAgKV0pOwogIH0pLCAxMjgKICAvKiBLRVlFRF9GUkFHTUVOVCAqLwogICkpXSkpIDogX2NyZWF0ZUNvbW1lbnRWTm9kZSgidi1pZiIsIHRydWUpXSk7Cn0="},{"version":3,"sources":["/Users/yanagi/programming/live-chat-vuejs/src/components/ChatWindow.vue"],"names":[],"mappings":";;;;;;;;AACO,EAAA,KAAK,EAAC;;;;sBACT,mBAAA,CAAkB,IAAlB,EAAkB,IAAlB,EAAI,WAAJ,EAAa,CAAA;AAAA;AAAb,G;;;;;AACqB,EAAA,KAAK,EAAC;;;AAGf,EAAA,KAAK,EAAC;;;;;AAGuB,EAAA,KAAK,EAAC;;;AAE/B,EAAA,KAAK,EAAC;;;AAGV,EAAA,KAAK,EAAC;;;;;uBAbpB,mBAAA,CAiBM,KAjBN,EAAA,UAAA,EAiBM,CAhBJ,UAgBI,EAfO,MAAA,CAAA,Q,kBAAX,mBAAA,CAcM,KAdN,EAAA,UAAA,EAcM,E,kBAbJ,mBAAA,CAYK,SAZL,EAYK,IAZL,EAYK,WAAA,CAZiB,MAAA,CAAA,QAYjB,EAZyB,UAAnB,OAAmB,EAAZ;yBAAlB,mBAAA,CAYK,IAZL,EAYK;AAZ4B,MAAA,GAAG,EAAE,OAAO,CAAC;AAYzC,KAZL,E,CACE,mBAAA,CAUK,IAVL,EAUK;AAVA,MAAA,KAAK,EAAA,eAAA,CAAA;AAAA,QAAA,QAAA,EAAc,OAAO,CAAC,KAAR,KAAkB,KAAA,CAAA,GAAhC;AAAmC,QAAA,IAAA,EAAQ,OAAO,CAAC,KAAR,KAAkB,KAAA,CAAA;AAA7D,OAAA;AAUL,KAVL,E,CACE,mBAAA,CAA4C,MAA5C,EAAA,UAAA,EAA4C,gBAAA,CAAtB,OAAO,CAAC,IAAc,CAA5C,EAAkC;AAAA;AAAlC,K,EACA,mBAAA,CAMM,KANN,EAMM;AAND,MAAA,KAAK,EAAC,SAML;AANgB,MAAA,UAAQ,EAAA,oBAAA,MAAA;AAAA,eAAE,QAAA,CAAA,UAAA,CAAW,OAAX,CAAF;AAAA;AAMxB,KANN,E,mCACK,OAAO,CAAC,O,IAAU,G,EACrB;AAAA;OAAW,OAAO,CAAC,KAAR,CAAc,M,kBAAzB,mBAAA,CAGM,KAHN,EAAA,UAAA,EAGM,CAFJ,YAAA,CAAgD,4BAAhD,EAAgD;AAA7B,MAAA,IAAI,EAAC,OAAwB;AAAhB,MAAA,KAAK,EAAC;AAAU,KAAhD,CAEI,EADJ,mBAAA,CAA2D,MAA3D,EAAA,UAAA,EAA2D,gBAAA,CAA9B,OAAO,CAAC,KAAR,CAAc,MAAgB,CAA3D,EAAiD;AAAA;AAAjD,KACI,CAHN,C,sCAFF,E;;AAAA,M,UAAA,C,EAOA,mBAAA,CAAwD,MAAxD,EAAA,UAAA,EAAwD,gBAAA,CAA5B,OAAO,CAAC,UAAoB,CAAxD,EAA8C;AAAA;AAA9C,K,CATF,E;;AAAA,K,CADF,C;GAYK,CAZL,E;;AAAA,GAaI,EAdN,C,qCAeI,CAjBN,C","sourcesContent":["<template>\n  <div class=\"chat-window\">\n    <h1>チャットウィンドウ</h1>\n    <div v-if=\"messages\" class=\"messages\">\n      <ul v-for=\"message in messages\" :key=\"message.id\">\n        <li :class=\"{ received: message.email !== uid, sent: message.email === uid }\">\n          <span class=\"name\">{{ message.name }}</span>\n          <div class=\"message\" @dblclick=\"handleLike(message)\">\n            {{ message.content }}\n            <div v-if=\"message.likes.length\" class=\"heart-container\">\n              <font-awesome-icon icon=\"heart\" class=\"heart\" />\n              <span class=\"heart-count\">{{ message.likes.length }}</span>\n            </div>\n          </div>\n          <span class=\"created-at\">{{ message.created_at }}</span>\n        </li>\n      </ul>\n    </div>\n  </div>\n</template>\n\n<script>\nimport axios from 'axios'\n\nexport default {\n  emits: ['connectCable'],\n  props: ['messages'],\n  data () {\n    return {\n      uid: localStorage.getItem('uid')\n    }\n  },\n  methods: {\n    handleLike (message) {\n      for (let i = 0; i < message.likes.length; i++) {\n        const like = message.likes[i]\n        if (like.email === this.uid) {\n          this.deleteLike(like.id, message.id)\n          return\n        }\n      }\n      this.createLike(message.id)\n    },\n    async createLike (messageId) {\n      try {\n        const res = await axios.post(`http://localhost:3000/messages/${messageId}/likes`, {},\n          {\n            headers: {\n              uid: this.uid,\n              \"access-token\": window.localStorage.getItem('access-token'),\n              client: window.localStorage.getItem('client')\n            }\n          })\n\n        if (!res) {\n          new Error('いいねできませんでした')\n        }\n        this.$emit('connectCable')\n      } catch (error) {\n        console.log(error)\n      }\n    },\n    async deleteLike(likeId) {\n      try {\n        const res = await axios.delete('http://localhost:3000/likes/${likeId}',\n        {\n          headers: {\n            uid: this.uid,\n            \"access-token\": window.localStorage.getItem('access-token'),\n            client: window.localStorage.getItem('client')\n          }\n        })\n\n        if (!res) {\n          new Error('いいねを削除できませんでした')\n        }\n        this.$emit('connectCable')\n      } catch (error) {\n        console.log(error)\n      }\n    },\n  }\n}\n</script>\n\n<style scoped>\n  .chat-window {\n    background: white;\n    padding: 30px 20px;\n    border-bottom: 1px solid #eee;\n  }\n  ul {\n    list-style: none;\n    margin: 0;\n    padding: 0;\n  }\n  ul li {\n    display:inline-block;\n    clear: both;\n  }\n  .received .message {\n    background: #eee;\n    padding: 10px;\n    display: inline-block;\n    border-radius: 30px;\n    margin-bottom: 2px;\n    max-width: 400px;\n  }\n  .received {\n    float: left;\n  }\n  .sent {\n    float: right;\n  }\n  .sent .message {\n    background: #677bb4;\n    color: white;\n    padding: 10px;\n    display: inline-block;\n    border-radius: 30px;\n    margin-bottom: 2px;\n    max-width: 400px;\n  }\n  .name {\n    position: relative;\n    margin-right: 6px;\n    display: block;\n    font-size: 13px;\n  }\n  .created-at {\n    display: block;\n    color: #999;\n    font-size: 12px;\n    margin-bottom: 20px;\n    margin-left: 4px;\n  }\n  .messages {\n    max-height: 400px;\n    overflow: auto;\n  }\n  .message {\n    position: relative;\n  }\n  .heart-container {\n    background: white;\n    position: absolute;\n    display: flex;\n    justify-content: space-around;\n    align-items: center;\n    border-radius: 30px;\n    min-width: 25px;\n    border-style: solid;\n    border-width: 1px;\n    border-color: rgb(245, 245, 245);\n    padding: 1px 2px;\n    z-index: 2;\n    bottom: -7px;\n    right: 0px;\n    font-size: 9px;\n  }\n  .heart {\n    color: rgb(236, 29, 29);\n  }\n  .heart-count {\n    color: rgb(20, 19, 19);\n  }\n  .received .message::selection {\n    background: #eee;\n  }\n\n  .sent .message::selection {\n    background: #677bb4;\n  }\n</style>\n"],"sourceRoot":""}]}