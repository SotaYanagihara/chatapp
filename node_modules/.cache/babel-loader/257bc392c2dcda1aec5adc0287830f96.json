{"remainingRequest":"/Users/yanagi/programming/live-chat-vuejs/node_modules/babel-loader/lib/index.js!/Users/yanagi/programming/live-chat-vuejs/node_modules/eslint-loader/index.js??ref--14-0!/Users/yanagi/programming/live-chat-vuejs/src/auth/validate.js","dependencies":[{"path":"/Users/yanagi/programming/live-chat-vuejs/src/auth/validate.js","mtime":1638957422907},{"path":"/Users/yanagi/programming/live-chat-vuejs/babel.config.js","mtime":1637909021919},{"path":"/Users/yanagi/programming/live-chat-vuejs/node_modules/cache-loader/dist/cjs.js","mtime":1637908768660},{"path":"/Users/yanagi/programming/live-chat-vuejs/node_modules/babel-loader/lib/index.js","mtime":1637908770962},{"path":"/Users/yanagi/programming/live-chat-vuejs/node_modules/eslint-loader/index.js","mtime":1637908768210}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy95YW5hZ2kvcHJvZ3JhbW1pbmcvbGl2ZS1jaGF0LXZ1ZWpzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgeyByZWYgfSBmcm9tICd2dWUnOwppbXBvcnQgcmVtb3ZlSXRlbSBmcm9tICcuL3JlbW92ZUl0ZW0nOwp2YXIgZXJyb3IgPSByZWYobnVsbCk7Cgp2YXIgdmFsaWRhdGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgdmFyIHVpZCwgY2xpZW50LCBhY2Nlc3NUb2tlbiwgcmVzOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBlcnJvci52YWx1ZSA9IG51bGw7CiAgICAgICAgICAgIHVpZCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndWlkJyk7CiAgICAgICAgICAgIGNsaWVudCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2xpZW50Jyk7CiAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY2Nlc3MtdG9rZW4nKTsKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDQ7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICByZXR1cm4gYXhpb3MuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXV0aC92YWxpZGF0ZV90b2tlbicsIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICB1aWQ6IHVpZCwKICAgICAgICAgICAgICAgICdhY2Nlc3MtdG9rZW4nOiBhY2Nlc3NUb2tlbiwKICAgICAgICAgICAgICAgIGNsaWVudDogY2xpZW50CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+iqjeiovOOBq+WkseaVl+OBl+OBvuOBl+OBnycpOwoKICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHJlcyk7CgogICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDEzOwogICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDQpOwogICAgICAgICAgICBlcnJvci52YWx1ZSA9ICfoqo3oqLzjgavlpLHmlZfjgZfjgb7jgZfjgZ8nOwogICAgICAgICAgICByZW1vdmVJdGVtKCk7CgogICAgICAgICAgY2FzZSAxNzoKICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlLCBudWxsLCBbWzQsIDEzXV0pOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIHZhbGlkYXRlKCkgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7Cgp2YXIgdXNlVmFsaWRhdGUgPSBmdW5jdGlvbiB1c2VWYWxpZGF0ZSgpIHsKICByZXR1cm4gewogICAgZXJyb3I6IGVycm9yLAogICAgdmFsaWRhdGU6IHZhbGlkYXRlCiAgfTsKfTsKCmV4cG9ydCBkZWZhdWx0IHVzZVZhbGlkYXRlOw=="},{"version":3,"sources":["/Users/yanagi/programming/live-chat-vuejs/src/auth/validate.js"],"names":["axios","ref","removeItem","error","validate","value","uid","window","localStorage","getItem","client","accessToken","get","headers","res","Error","useValidate"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,GAAT,QAAoB,KAApB;AACA,OAAOC,UAAP,MAAuB,cAAvB;AACA,IAAMC,KAAK,GAAGF,GAAG,CAAC,IAAD,CAAjB;;AAEA,IAAMG,QAAQ;AAAA,qEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AACfD,YAAAA,KAAK,CAACE,KAAN,GAAc,IAAd;AACMC,YAAAA,GAFS,GAEHC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,KAA5B,CAFG;AAGTC,YAAAA,MAHS,GAGAH,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,QAA5B,CAHA;AAITE,YAAAA,WAJS,GAIKJ,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,cAA5B,CAJL;AAAA;AAAA;AAAA,mBAOKT,KAAK,CAACY,GAAN,CAAU,2CAAV,EAAuD;AACvEC,cAAAA,OAAO,EAAE;AACPP,gBAAAA,GAAG,EAAEA,GADE;AAEP,gCAAgBK,WAFT;AAGPD,gBAAAA,MAAM,EAAEA;AAHD;AAD8D,aAAvD,CAPL;;AAAA;AAOPI,YAAAA,GAPO;;AAAA,gBAeRA,GAfQ;AAAA;AAAA;AAAA;;AAAA,kBAgBL,IAAIC,KAAJ,CAAU,WAAV,CAhBK;;AAAA;AAAA,6CAmBND,GAnBM;;AAAA;AAAA;AAAA;AAqBbX,YAAAA,KAAK,CAACE,KAAN,GAAc,WAAd;AACAH,YAAAA,UAAU;;AAtBG;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAARE,QAAQ;AAAA;AAAA;AAAA,GAAd;;AA0BA,IAAMY,WAAW,GAAG,SAAdA,WAAc,GAAM;AACxB,SAAO;AAAEb,IAAAA,KAAK,EAALA,KAAF;AAASC,IAAAA,QAAQ,EAARA;AAAT,GAAP;AACD,CAFD;;AAIA,eAAeY,WAAf","sourcesContent":["import axios from 'axios'\nimport { ref } from 'vue'\nimport removeItem from './removeItem'\nconst error = ref(null)\n\nconst validate = async () => {\n  error.value = null\n  const uid = window.localStorage.getItem('uid')\n  const client = window.localStorage.getItem('client')\n  const accessToken = window.localStorage.getItem('access-token')\n\n  try {\n    const res = await axios.get('http://localhost:3000/auth/validate_token', {\n      headers: {\n        uid: uid,\n        'access-token': accessToken,\n        client: client\n      }\n    })\n\n    if (!res) {\n      throw new Error('認証に失敗しました')\n    }\n\n    return res\n  } catch (err) {\n    error.value = '認証に失敗しました'\n    removeItem()\n  }\n}\n\nconst useValidate = () => {\n  return { error, validate }\n}\n\nexport default useValidate\n"]}]}