{"remainingRequest":"/Users/yanagi/programming/live-chat-vuejs/node_modules/babel-loader/lib/index.js!/Users/yanagi/programming/live-chat-vuejs/node_modules/eslint-loader/index.js??ref--14-0!/Users/yanagi/programming/live-chat-vuejs/src/auth/validate.js","dependencies":[{"path":"/Users/yanagi/programming/live-chat-vuejs/src/auth/validate.js","mtime":1638778678068},{"path":"/Users/yanagi/programming/live-chat-vuejs/babel.config.js","mtime":1637909021919},{"path":"/Users/yanagi/programming/live-chat-vuejs/node_modules/cache-loader/dist/cjs.js","mtime":1637908768660},{"path":"/Users/yanagi/programming/live-chat-vuejs/node_modules/babel-loader/lib/index.js","mtime":1637908770962},{"path":"/Users/yanagi/programming/live-chat-vuejs/node_modules/eslint-loader/index.js","mtime":1637908768210}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy95YW5hZ2kvcHJvZ3JhbW1pbmcvbGl2ZS1jaGF0LXZ1ZWpzL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9hc3luY1RvR2VuZXJhdG9yLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgYXhpb3MgZnJvbSAnYXhpb3MnOwppbXBvcnQgeyByZWYgfSBmcm9tICd2dWUnOwp2YXIgZXJyb3IgPSByZWYobnVsbCk7Cgp2YXIgdmFsaWRhdGUgPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKCkgewogICAgdmFyIHVpZCwgY2xpZW50LCBhY2Nlc3NUb2tlbiwgcmVzOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICBlcnJvci52YWx1ZSA9IG51bGw7CiAgICAgICAgICAgIHVpZCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndWlkJyk7CiAgICAgICAgICAgIGNsaWVudCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2xpZW50Jyk7CiAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY2Nlc3MtdG9rZW4nKTsKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDQ7CiAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICByZXR1cm4gYXhpb3MuZ2V0KCdodHRwOi8vbG9jYWxob3N0OjMwMDAvYXV0aC92YWxpZGF0ZV90b2tlbicsIHsKICAgICAgICAgICAgICBoZWFkZXJzOiB7CiAgICAgICAgICAgICAgICB1aWQ6IHVpZCwKICAgICAgICAgICAgICAgICdhY2Nlc3MtdG9rZW4nOiBhY2Nlc3NUb2tlbiwKICAgICAgICAgICAgICAgIGNsaWVudDogY2xpZW50CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KTsKCiAgICAgICAgICBjYXNlIDc6CiAgICAgICAgICAgIHJlcyA9IF9jb250ZXh0LnNlbnQ7CgogICAgICAgICAgICBpZiAocmVzKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDEwOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ+iqjeiovOOBq+WkseaVl+OBl+OBvuOBl+OBnycpOwoKICAgICAgICAgIGNhc2UgMTA6CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dC5hYnJ1cHQoInJldHVybiIsIHJlcyk7CgogICAgICAgICAgY2FzZSAxMzoKICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDEzOwogICAgICAgICAgICBfY29udGV4dC50MCA9IF9jb250ZXh0WyJjYXRjaCJdKDQpOwogICAgICAgICAgICBlcnJvci52YWx1ZSA9ICfoqo3oqLzjgavlpLHmlZfjgZfjgb7jgZfjgZ8nOwogICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ3VpZCcpOwogICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2FjY2Vzcy10b2tlbicpOwogICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ2NsaWVudCcpOwogICAgICAgICAgICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oJ25hbWUnKTsKCiAgICAgICAgICBjYXNlIDIwOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbNCwgMTNdXSk7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gdmFsaWRhdGUoKSB7CiAgICByZXR1cm4gX3JlZi5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH07Cn0oKTsKCnZhciB1c2VWYWxpZGF0ZSA9IGZ1bmN0aW9uIHVzZVZhbGlkYXRlKCkgewogIHJldHVybiB7CiAgICBlcnJvcjogZXJyb3IsCiAgICB2YWxpZGF0ZTogdmFsaWRhdGUKICB9Owp9OwoKZXhwb3J0IGRlZmF1bHQgdXNlVmFsaWRhdGU7"},{"version":3,"sources":["/Users/yanagi/programming/live-chat-vuejs/src/auth/validate.js"],"names":["axios","ref","error","validate","value","uid","window","localStorage","getItem","client","accessToken","get","headers","res","Error","removeItem","useValidate"],"mappings":";;AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,SAASC,GAAT,QAAoB,KAApB;AACA,IAAMC,KAAK,GAAGD,GAAG,CAAC,IAAD,CAAjB;;AAEA,IAAME,QAAQ;AAAA,qEAAG;AAAA;AAAA;AAAA;AAAA;AAAA;AACfD,YAAAA,KAAK,CAACE,KAAN,GAAc,IAAd;AACMC,YAAAA,GAFS,GAEHC,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,KAA5B,CAFG;AAGTC,YAAAA,MAHS,GAGAH,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,QAA5B,CAHA;AAITE,YAAAA,WAJS,GAIKJ,MAAM,CAACC,YAAP,CAAoBC,OAApB,CAA4B,cAA5B,CAJL;AAAA;AAAA;AAAA,mBAOKR,KAAK,CAACW,GAAN,CAAU,2CAAV,EAAuD;AACvEC,cAAAA,OAAO,EAAE;AACPP,gBAAAA,GAAG,EAAEA,GADE;AAEP,gCAAgBK,WAFT;AAGPD,gBAAAA,MAAM,EAAEA;AAHD;AAD8D,aAAvD,CAPL;;AAAA;AAOPI,YAAAA,GAPO;;AAAA,gBAeRA,GAfQ;AAAA;AAAA;AAAA;;AAAA,kBAgBL,IAAIC,KAAJ,CAAU,WAAV,CAhBK;;AAAA;AAAA,6CAmBND,GAnBM;;AAAA;AAAA;AAAA;AAqBbX,YAAAA,KAAK,CAACE,KAAN,GAAc,WAAd;AACAE,YAAAA,MAAM,CAACC,YAAP,CAAoBQ,UAApB,CAA+B,KAA/B;AACAT,YAAAA,MAAM,CAACC,YAAP,CAAoBQ,UAApB,CAA+B,cAA/B;AACAT,YAAAA,MAAM,CAACC,YAAP,CAAoBQ,UAApB,CAA+B,QAA/B;AACAT,YAAAA,MAAM,CAACC,YAAP,CAAoBQ,UAApB,CAA+B,MAA/B;;AAzBa;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAH;;AAAA,kBAARZ,QAAQ;AAAA;AAAA;AAAA,GAAd;;AA6BA,IAAMa,WAAW,GAAG,SAAdA,WAAc,GAAM;AACxB,SAAO;AAAEd,IAAAA,KAAK,EAALA,KAAF;AAASC,IAAAA,QAAQ,EAARA;AAAT,GAAP;AACD,CAFD;;AAIA,eAAea,WAAf","sourcesContent":["import axios from 'axios'\nimport { ref } from 'vue'\nconst error = ref(null)\n\nconst validate = async () => {\n  error.value = null\n  const uid = window.localStorage.getItem('uid')\n  const client = window.localStorage.getItem('client')\n  const accessToken = window.localStorage.getItem('access-token')\n\n  try {\n    const res = await axios.get('http://localhost:3000/auth/validate_token', {\n      headers: {\n        uid: uid,\n        'access-token': accessToken,\n        client: client\n      }\n    })\n\n    if (!res) {\n      throw new Error('認証に失敗しました')\n    }\n\n    return res\n  } catch (err) {\n    error.value = '認証に失敗しました'\n    window.localStorage.removeItem('uid')\n    window.localStorage.removeItem('access-token')\n    window.localStorage.removeItem('client')\n    window.localStorage.removeItem('name')\n  }\n}\n\nconst useValidate = () => {\n  return { error, validate }\n}\n\nexport default useValidate\n"]}]}