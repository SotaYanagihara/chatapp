{"remainingRequest":"/Users/yanagi/chatapp/live-chat-rails/node_modules/babel-loader/lib/index.js!/Users/yanagi/chatapp/live-chat-rails/node_modules/eslint-loader/index.js??ref--14-0!/Users/yanagi/chatapp/live-chat-rails/src/router/index.js","dependencies":[{"path":"/Users/yanagi/chatapp/live-chat-rails/src/router/index.js","mtime":1638779131793},{"path":"/Users/yanagi/chatapp/live-chat-rails/babel.config.js","mtime":1637909021919},{"path":"/Users/yanagi/chatapp/live-chat-rails/node_modules/cache-loader/dist/cjs.js","mtime":1637908768660},{"path":"/Users/yanagi/chatapp/live-chat-rails/node_modules/babel-loader/lib/index.js","mtime":1637908770962},{"path":"/Users/yanagi/chatapp/live-chat-rails/node_modules/eslint-loader/index.js","mtime":1637908768210}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9hc3luY1RvR2VuZXJhdG9yIGZyb20gIi9Vc2Vycy95YW5hZ2kvY2hhdGFwcC9saXZlLWNoYXQtcmFpbHMvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IuanMiOwppbXBvcnQgInJlZ2VuZXJhdG9yLXJ1bnRpbWUvcnVudGltZS5qcyI7CmltcG9ydCB7IGNyZWF0ZVJvdXRlciwgY3JlYXRlV2ViSGlzdG9yeSB9IGZyb20gJ3Z1ZS1yb3V0ZXInOwppbXBvcnQgV2VsY29tZSBmcm9tICcuLi92aWV3cy9XZWxjb21lJzsKaW1wb3J0IENoYXRyb29tIGZyb20gJy4uL3ZpZXdzL0NoYXRyb29tJzsKaW1wb3J0IHVzZVZhbGlkYXRlIGZyb20gJy4uL2F1dGgvdmFsaWRhdGUnOwoKdmFyIF91c2VWYWxpZGF0ZSA9IHVzZVZhbGlkYXRlKCksCiAgICBlcnJvciA9IF91c2VWYWxpZGF0ZS5lcnJvciwKICAgIHZhbGlkYXRlID0gX3VzZVZhbGlkYXRlLnZhbGlkYXRlOyAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tdW51c2VkLXZhcnMKCgp2YXIgcmVxdWlyZUF1dGggPSAvKiNfX1BVUkVfXyovZnVuY3Rpb24gKCkgewogIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHRvLCBmcm9tLCBuZXh0KSB7CiAgICB2YXIgdWlkLCBjbGllbnQsIGFjY2Vzc1Rva2VuOwogICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICB1aWQgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ3VpZCcpOwogICAgICAgICAgICBjbGllbnQgPSB3aW5kb3cubG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2NsaWVudCcpOwogICAgICAgICAgICBhY2Nlc3NUb2tlbiA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnYWNjZXNzLXRva2VuJyk7CgogICAgICAgICAgICBpZiAoISghdWlkIHx8ICFjbGllbnQgfHwgIWFjY2Vzc1Rva2VuKSkgewogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA3OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBjb25zb2xlLmxvZygn44Ot44Kw44Kk44Oz44GX44Gm44GE44G+44Gb44KTJyk7CiAgICAgICAgICAgIG5leHQoewogICAgICAgICAgICAgIG5hbWU6ICdXZWxjb21lJwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LmFicnVwdCgicmV0dXJuIik7CgogICAgICAgICAgY2FzZSA3OgogICAgICAgICAgICBfY29udGV4dC5uZXh0ID0gOTsKICAgICAgICAgICAgcmV0dXJuIHZhbGlkYXRlKCk7CgogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgICBpZiAoZXJyb3IudmFsdWUpIHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygn6KqN6Ki844Gr5aSx5pWX44GX44G+44GX44GfJyk7CiAgICAgICAgICAgICAgbmV4dCh7CiAgICAgICAgICAgICAgICBuYW1lOiAnV2VsY29tZScKICAgICAgICAgICAgICB9KTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIH0KCiAgICAgICAgICBjYXNlIDEwOgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sIF9jYWxsZWUpOwogIH0pKTsKCiAgcmV0dXJuIGZ1bmN0aW9uIHJlcXVpcmVBdXRoKF94LCBfeDIsIF94MykgewogICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7Cgp2YXIgbm9SZXF1aXJlQXV0aCA9IC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgdmFyIF9yZWYyID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlMih0bywgZnJvbSwgbmV4dCkgewogICAgdmFyIHVpZCwgY2xpZW50LCBhY2Nlc3NUb2tlbjsKICAgIHJldHVybiByZWdlbmVyYXRvclJ1bnRpbWUud3JhcChmdW5jdGlvbiBfY2FsbGVlMiQoX2NvbnRleHQyKSB7CiAgICAgIHdoaWxlICgxKSB7CiAgICAgICAgc3dpdGNoIChfY29udGV4dDIucHJldiA9IF9jb250ZXh0Mi5uZXh0KSB7CiAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgIHVpZCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgndWlkJyk7CiAgICAgICAgICAgIGNsaWVudCA9IHdpbmRvdy5sb2NhbFN0b3JhZ2UuZ2V0SXRlbSgnY2xpZW50Jyk7CiAgICAgICAgICAgIGFjY2Vzc1Rva2VuID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKCdhY2Nlc3MtdG9rZW4nKTsKCiAgICAgICAgICAgIGlmICghKCF1aWQgJiYgIWNsaWVudCAmJiAhYWNjZXNzVG9rZW4pKSB7CiAgICAgICAgICAgICAgX2NvbnRleHQyLm5leHQgPSA2OwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CgogICAgICAgICAgICBuZXh0KCk7CiAgICAgICAgICAgIHJldHVybiBfY29udGV4dDIuYWJydXB0KCJyZXR1cm4iKTsKCiAgICAgICAgICBjYXNlIDY6CiAgICAgICAgICAgIF9jb250ZXh0Mi5uZXh0ID0gODsKICAgICAgICAgICAgcmV0dXJuIHZhbGlkYXRlKCk7CgogICAgICAgICAgY2FzZSA4OgogICAgICAgICAgICBpZiAoIWVycm9yLnZhbHVlKSB7CiAgICAgICAgICAgICAgbmV4dCh7CiAgICAgICAgICAgICAgICBuYW1lOiAnQ2hhdHJvb20nCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgbmV4dCgpOwogICAgICAgICAgICB9CgogICAgICAgICAgY2FzZSA5OgogICAgICAgICAgY2FzZSAiZW5kIjoKICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0Mi5zdG9wKCk7CiAgICAgICAgfQogICAgICB9CiAgICB9LCBfY2FsbGVlMik7CiAgfSkpOwoKICByZXR1cm4gZnVuY3Rpb24gbm9SZXF1aXJlQXV0aChfeDQsIF94NSwgX3g2KSB7CiAgICByZXR1cm4gX3JlZjIuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9Owp9KCk7Cgp2YXIgcm91dGVzID0gW3sKICBwYXRoOiAnLycsCiAgbmFtZTogJ1dlbGNvbWUnLAogIGNvbXBvbmVudDogV2VsY29tZSwKICBiZWZvcmVFbnRlcjogbm9SZXF1aXJlQXV0aAp9LCB7CiAgcGF0aDogJy9jaGF0cm9vbScsCiAgbmFtZTogJ0NoYXRyb29tJywKICBjb21wb25lbnQ6IENoYXRyb29tLAogIGJlZm9yZUVudGVyOiByZXF1aXJlQXV0aAp9XTsKdmFyIHJvdXRlciA9IGNyZWF0ZVJvdXRlcih7CiAgaGlzdG9yeTogY3JlYXRlV2ViSGlzdG9yeShwcm9jZXNzLmVudi5CQVNFX1VSTCksCiAgcm91dGVzOiByb3V0ZXMKfSk7CmV4cG9ydCBkZWZhdWx0IHJvdXRlcjs="},{"version":3,"sources":["/Users/yanagi/chatapp/live-chat-rails/src/router/index.js"],"names":["createRouter","createWebHistory","Welcome","Chatroom","useValidate","error","validate","requireAuth","to","from","next","uid","window","localStorage","getItem","client","accessToken","console","log","name","value","noRequireAuth","routes","path","component","beforeEnter","router","history","process","env","BASE_URL"],"mappings":"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","sourcesContent":["import { createRouter, createWebHistory } from 'vue-router'\nimport Welcome from '../views/Welcome'\nimport Chatroom from '../views/Chatroom'\nimport useValidate from '../auth/validate'\n\nconst { error, validate } = useValidate()\n\n// eslint-disable-next-line no-unused-vars\nconst requireAuth = async (to, from, next) => {\n  const uid = window.localStorage.getItem('uid')\n  const client = window.localStorage.getItem('client')\n  const accessToken = window.localStorage.getItem('access-token')\n\n  if (!uid || !client || !accessToken) {\n    console.log('ログインしていません')\n    next({ name: 'Welcome' })\n    return\n  }\n\n  await validate()\n\n  if (error.value) {\n    console.log('認証に失敗しました')\n    next({ name: 'Welcome' })\n  } else {\n    next()\n  }\n}\n\nconst noRequireAuth = async (to, from, next) => {\n  const uid = window.localStorage.getItem('uid')\n  const client = window.localStorage.getItem('client')\n  const accessToken = window.localStorage.getItem('access-token')\n\n  if (!uid && !client && !accessToken) {\n    next()\n    return\n  }\n\n  await validate()\n\n  if (!error.value) {\n    next({ name: 'Chatroom' })\n  } else {\n    next()\n  }\n}\n\nconst routes = [\n  {\n    path: '/',\n    name: 'Welcome',\n    component: Welcome,\n    beforeEnter: noRequireAuth\n  },\n  {\n    path: '/chatroom',\n    name: 'Chatroom',\n    component: Chatroom,\n    beforeEnter: requireAuth\n  }\n]\n\nconst router = createRouter({\n  history: createWebHistory(process.env.BASE_URL),\n  routes\n})\n\nexport default router\n"]}]}